<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{common::header}">
</head>
<body>
<div class="container-xxl bg-white p-0">
	<div th:replace="~{common::nav}"></div>

	<!-- Write Form Section Start -->
	<div class="container py-5">
		<h2 class="mb-4">글 작성</h2>
		<form th:action="@{/write}" method="post" enctype="multipart/form-data" onsubmit="return prepareSubmit()">
			<div class="mb-3">
				<label for="title" class="form-label">제목</label>
				<input type="text" class="form-control" id="title" name="title" placeholder="제목을 입력하세요" required>
			</div>

			<div class="mb-3">
				<label for="category" class="form-label">대분류</label>
				<select class="form-select" id="category" name="category" required>
					<option value="" disabled selected>select category</option>
					<option value="java&spring">java & spring</option>
					<option value="linux">linux</option>
					<option value="web">web</option>
					<option value="history">history</option>
					<option value="about">about</option>
					<option value="etc">etc</option>
				</select>
			</div>

			<div class="mb-3">
				<label for="editor" class="form-label">내용</label>
				<div id="editor" style="height: 300px;"></div>
				<input type="hidden" name="content" id="hidden-content" />
			</div>

			<div class="filebox mb-3">
				<input class="upload-name" placeholder="첨부파일" disabled>
				<label for="files">파일찾기</label>
				<input type="file" id="files" name="files" multiple>
			</div>

			<button type="submit" class="btn btn-primary">작성 완료</button>
		</form>
	</div>

	<footer th:replace="~{common::footer}"></footer>
</div>

<!-- Quill JS -->
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<!-- JavaScript Libraries -->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{lib/wow/wow.js}"></script>
<script th:src="@{lib/easing/easing.min.js}"></script>
<script th:src="@{lib/waypoints/waypoints.min.js}"></script>
<script th:src="@{lib/owlcarousel/owl.carousel.min.js}"></script>
<script th:src="@{js/main.js}"></script>

<script>
	$("#files").on('change', function () {
		let fileNames = Array.from(this.files).map(file => file.name).join(', ');
		$(".upload-name").val(fileNames);
	});

	const quill = new Quill('#editor', {
		theme: 'snow',
		placeholder: '내용을 입력하세요...',
		modules: {
			toolbar: [
				[{ 'header': [1, 2, false] }],
				['bold', 'italic', 'underline', 'strike'],
				[{ 'list': 'ordered' }, { 'list': 'bullet' }],
				['link', 'image'],
				['clean']
			]
		}
	});

	function prepareSubmit() {
		const content = document.querySelector('#hidden-content');
		content.value = quill.root.innerHTML;
		return true;
	}
</script>
</body>
</html>
